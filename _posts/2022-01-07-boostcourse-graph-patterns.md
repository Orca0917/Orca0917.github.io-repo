---
title:  "[부스트코스 - 그래프와 추천 시스템] 그래프 패턴"
excerpt: "실제 그래프와 랜덤 그래프에 대한소개, 실제 그래프의 다양한 패턴들 (작은 세상 효과, 연결성의 두터운 꼬리분포, 군집구조)"

categories:
  - boostcourse
tags:
  - [AI, Naver, BoostCourse]
toc: true
toc_sticky: true
 
date: 2022-01-07
last_modified_at: 2022-01-07
---
📌 **알립니다!**<br>
이번에 작성되는 글은 **네이버 부스트코스 - 그래프와 추천 시스템**를 수강하며 정리하는 글입니다.<br>
여기서 존재하는 강의 자료의 출처는 네이버 부스트코스에게 있습니다.
{: .notice--info}

# 실제 그래프와 랜덤 그래프
## 실제 그래프
실제 그래프(Real Graph)는 <u>다양한 복잡계로부터 얻어진 그래프</u>를 의미한다. 좀 더 쉽게 말해, 다양한 실제 데이터로부터 얻어낸 그래프를 말한다.
### 종류
![image](https://user-images.githubusercontent.com/91870042/148515727-72bc980f-19fc-4a13-a9b6-b7213013bcea.png){: .align-center}

소셜네트워크, 전자상거래 구매 내역, 인터넷, 웹, 뇌, 단백질의 상호작용, 지식그래프

## 랜덤 그래프
랜덤 그래프(Random Graph)는 <u>확률적 과정을 통해 생성한 그래프</u>를 의미한다. 실제 데이터와 달리 인공적으로 만든 그래프이며, **정점들간의 연결(간선)이 확률을 따른다**. 여기서는 **에르되스와 레니가 제안한 랜덤 그래프 모델**을 가지고 실제 그래프와 랜덤 그래프를 비교한다.

### 에르되스-레니 랜덤 그래프
에르되스-레니의 랜덤 그래프(Erdős-Rényi Random Graph)는 앞서 말했듯이, <u>임의의 두 정점 사이에 간선이 존재하는지 여부는 동일한 확률 분포에 의해 결정이 된다.</u>

랜덤 그래프를 \\(G(n, p)\\)라고 하였을 때, \\(G(n, p)\\)는 다음을 의미한다.
- 그래프는 \\(n\\)개의 정점을 가진다.
- 그래프에서 임의의 두 정점 사이에 간선이 존재할 확률은 \\(p\\)이다.
- 정점간의 연결은 서로 **독립적**이다. (정점1과 정점2의 연결이 정점2와 정점3의 연결에 영향을 미치지 않는다.)

---
예를 들어, \\(G(3, 0.3)\\) 의 랜덤그래프를 생성하였다고 하자. 이때 생성될 수 있는 그래프의 종류는 무엇이고 그 확률에 대해서 확인해보면 다음과 같다.
1. 정점 3개 사이에 간선이 아무 간선도 존재하지 않는 그래프
2. 정점 3개 사이에 간선이 1개 존재하는 그래프
3. 정점 3개 사이에 간선이 2개 존재하는 그래프
4. 정점 3개 사이에 간선이 3개(모두 연결되어 있는) 그래프

![image](https://user-images.githubusercontent.com/91870042/148519133-5fc2bb36-c97f-4865-9cb0-4e2b74881162.png){: .align-center}

위의 예제에서 알 수 있듯이, 간선이 생기는 각각의 확률은 독립적이기 때문에 곱셈으로 연산이 된다.

<br>

# 그래프에서의 경로, 거리, 지름
## 경로
정점 u와 정점 v사이의 경로(Path)는 아래 조건을 만족하는 정점들의 순열이다.
- u에서 시작해서 v에서 끝나야 한다.
- 순열에서 **연속된 정점은 간선으로 연결**되어 있어야 한다.

![image](https://user-images.githubusercontent.com/91870042/148521612-62fc4d73-5f6f-4837-9768-e8ca5649f677.png){: .align-center}

위의 그래프에서 나올 수 있는 경로의 예시를 살펴보자. 아래의 예시를 보면, 인접한 정점끼리 간선으로 연결되어 있음을 알 수 있다. 하지만, 가장 마지막 예시는 1번 정점과 4번정점을 연결하는 간선이 없으므로, 경로가 아니다.
- 1-2-4-5-6
- 1-3-2-4-5
- 1-2-3-2-4-5-6
- <span style="color:red">1-4-5-6</span>

## 거리
경로의 거리(Distance)는 정점 u와 정점v 사이의 **최단 경로의 길이**이다.
![image](https://user-images.githubusercontent.com/91870042/148521612-62fc4d73-5f6f-4837-9768-e8ca5649f677.png){: .align-center}
위의 그래프에서 정점1과, 정점5 사이의 거리는 3이 된다. (1-2-4-5 또는 1-3-4-5)

## 지름
그래프의 지름(Diameter)는 **정점 간 거리의 최대값**이다. 더 풀어 말해 정점간 최단경로 길이의 최대값을 의미한다. 위에서 본 그래프에서는 1번 정점~ 6번 정점에 해당하는 거리 4가 지름이 된다.

<br>

# 실제 그래프의 구조적 특징
## 작은 세상 효과
> 여섯 단계 분리(Six Degrees of Separation) 실험  
> 미국에서 임의의 두 사람을 골랐을 때, 몇 단계의 지인을 거쳐서 연결이 될 수 있을까?

1960년대에, 사회학자인 스탠리 밀그램에 의해 실행된 실험으로서, A지역에 있는 사람들에게 편지를 주고 B지역의 다른 사람에게 오직 지인을 통해 편지를 전달하여 도착하게 끔 하였다. 편지를 전달하는 과정에서 비협조적인 사람도 있었기에 25%의 편지만 도착했지만, 평균 **6명**만을 거쳐서 도착할 수 있었다.

이러한 현상을 **작은 세상 효과**(Small world Effect)라고 한다. 한국에서는 이를 사돈의 팔촌 이라는 표현으로 사용이 된다.

이 작은 세상효과는 높은 확률로 랜덤그래프에서도 존재한다. 예를 들어, 각 사람당 100명의 지인을 알고 있다고 해보자. 이랬을 때, 5사람만 거치게 되어도 약 \\(100^5\\), 100억명의 사람과 연결이 될 수 있다. 실제로는 각각 아는 지인 100명 중에서도 중복이 존재할 수 있지만 그렇다고 해도 정말 많은 사람과 연결이 될 수 있다. 하지만, 이런 작은 세상 효과는 모든 그래프에서 존재하는 것은 아니다. 다음과 같은 그래프에서는 작은 세상 효과가 존재하지 않는다.

### 체인 그래프
![image](https://user-images.githubusercontent.com/91870042/148524831-93cca07a-7a5e-407f-8b35-05804fdab16f.png){: .align-center}
중복을 제외하고 오직 아는 사람이 1명인 경우, 마지막 사람까지 도달하기 위해서는 그 경로의 길이만큼 사람을 거쳐야만 한다.

### 사이클 그래프
![image](https://user-images.githubusercontent.com/91870042/148524912-91abeb59-3b31-4c44-9560-f035e26a15e0.png){: .align-center}
외부로 나가지 못하고 계속 내부 집단에만 머무르는 구조이다.

### 격자 그래프
![image](https://user-images.githubusercontent.com/91870042/148525082-03912476-4183-41af-8bb0-4456fe1d5183.png){: .align-center}
너무 많은 중복이 껴있어서 작은 세상 효과를 기대하기 어렵다.

## 연결성의 두터운 꼬리 분포
### 연결성
정점의 **연결성**(Degree)는 그 정점과 연결된 간선의 수를 의미한다. 정점v의 연결성은 **해당 정점의 이웃들의 수**와 동일하다. v의 연결성은 표기할 때, \\(d(v), d_v, \|N(v)\|\\)로 적는다.

방향성이 있는 그래프에서는 연결성도 다시 **나가는 연결성**(Out Degree, 외차수)와 **들어오는 연결성** (In Degree, 내차수)로 구분할 수 있다.
- 나가는 연결성: 정점 v에서 밖으로 나가는 연결성이며 표기할 때는 \\(d_{out}(v), \|N_{out}(v)\|\\)로 한다.
- 들어오는 연결성: 정점 v로 들어오는 연결성이며 표기할 때는 \\(d_{in}(v), \|N_{in}(v)\|\\)로 한다.

![image](https://user-images.githubusercontent.com/91870042/148534288-75640ee0-ce23-4cdd-968f-4dfbef61f181.png){: .align-center}
\begin{aligned}
    d_{in}(1) = 0, d_{out}(1) = 2 \hspace{10mm}
    d_{in}(2) = 1, d_{out}(2) = 0 \\\\\\
    d_{in}(3) = 2, d_{out}(3) = 1 \hspace{10mm}
    d_{in}(4) = 2, d_{out}(4) = 1 \\\\\\
    d_{in}(5) = 1, d_{out}(5) = 3 \hspace{10mm} 
    d_{in}(6) = 1, d_{out}(6) = 0
\end{aligned}

<br>

### 꼬리 분포
**실제 그래프의 연결성 분포**는 **두터운 꼬리**를 갖는다. 즉, 연결성이 매우 높은 허브(HUB) 정점이 존재함을 의미한다. 연결성이 매우 높은 정점 (허브 정점)의 예시로 SNS를 보자. 

SNS에서는 유명인의 경우, 10만~1000만 정도의 정말 많은 사람의 팔로워를 지닌 계정이 있다. 이 계정은 연결된 이웃이 많은 연결성이 높은 정점이라고 할 수 있다. 아래 그래프를 보면, 긴 꼬리 형태를 가진 그래프 형태를 가지고 있는데, 이는 연결성이 높은 정점은 그 수가 적다는 것을 의미한다.
![image](https://user-images.githubusercontent.com/91870042/148535931-4ac34bb3-6db5-4031-90e3-b230f2f98e79.png){: .align-center}

하지만, **랜덤 그래프의 연결성 분포**는 높은 확률로 **정규 분포**와 유사하게 나온다. 이 경우, 연결성이 높은 허브 정점이 존재할 가능성은 거의 0에 가깝다. 정규 분포와 유사한 예시로는 키의 분포가 있는데 키가 10m가 넘는 극단적인 예외는 존재하지 않는다.

![image](https://user-images.githubusercontent.com/91870042/148536950-5637c364-fe9e-42c0-8759-30f74dbb2dee.png){: .align-center}

실제 그래프와 랜덤 그래프의 비교

![image](https://user-images.githubusercontent.com/91870042/148537159-c37a80da-89ae-4675-8618-608125ff2f62.png){: .align-center}


## 거대 연결 구조
**연결 요소**(Connected Component)는 다음 조건들을 만족하는 정점들의 집합을 의미한다.
- 연결요소에 속하는 정점들은 경로에 연결될 수 없다.(= 하나의 연결요소에 속한 정점들은 직,간접적으로 서로 연결되어 있다.)
- 위의 조건을 만족하면서 정점을 추가할 수 없다.(= 직,간접적으로 연결된 정점들은 모두 하나의 연결요소에 포함된다.)

![image](https://user-images.githubusercontent.com/91870042/148538334-862f09e6-cfe0-4e39-880d-95dc4f47cc36.png){: .align-center}
위의 그래프에서는 총 3개의 연결요소 (1, 2, 3, 4, 5) (6, 7, 8) (9) 가 있음을 확인할 수 있다.

실제 그래프에서는 거대 연결 요소(Giant Connected Component)가 존재한다. 거대 연결 요소는 대다수의 정점을 포함한다.  
![image](https://user-images.githubusercontent.com/91870042/148538604-7201f9dd-9bb7-4585-840d-52ca3ab26eb9.png){: .align-center}

랜덤 그래프에서도 거대 연결 요소가 존재하는데, 조건이 필요하다. 정점들의 평균 연결성이 1보다 충분히 커야 발생한다.
![image](https://user-images.githubusercontent.com/91870042/148538661-1e2283de-d43e-455f-84dd-014ac99793e1.png){: .align-center}

## 군집 구조
### 군집
**군집** (Community)는 다음 조건들을 만족하는 정점들의 집합을 의미한다.
- 집합에 속하는 정점 사이에 많은 간선이 존재해야 한다.
- 집합에 속하는 정점과 그렇지 않은 정점 사이에는 적은 수의 간선이 존재한다.

이는 많다, 적다와 같은 수학적으로 모호한 표현이 사용되었기 때문에, 수학적으로 엄밀한 정의는 아니다. 아래의 그래프에서는 11개의 군집이 있는것을 눈으로 확인할 수 있다.

![image](https://user-images.githubusercontent.com/91870042/148538837-a8514e8b-c331-400d-8521-0542240cc1d0.png){: .align-center}

### 지역적 군집 계수
**지역적 군집 계수**(Local Clustering Coefficient)는 <u>한 정점에서의 군집의 형성 정도를 측정</u>한다. 정점v의 지역적 군집계수는 정점 v의 이웃 쌍 중 간선으로 직접 연결된 것의 비율을 의미한다. 정점 v의 지역적 군집계수를 \\(C_v\\)로 표현한다. 지역적 군집계수는 이웃쌍의 간선의 수가 많아질 수록 군집계수가 높아진다.

![image](https://user-images.githubusercontent.com/91870042/148541476-0be125fc-1aed-4998-8cfb-43dc08726316.png){: .align-center}

위의 예시 그래프를 보면, 정점1의 이웃은 4개이고, 총 6개(=\\(_4C_2\\))의 이웃쌍이 존재한다. 그 중에서 3개의 쌍이 간선으로 직접 연결이 되어 있다. 따라서 \\(C_v = 3/6 = 0.5\\)이다.
추가로, <u>연결성이 0인 정점에 대해서는 분모가 0이 되기 때문에 지역적 군집 계수가 정의되지 않는다.</u>

### 지역적 군집계수와 군집의 연관성
지역적 군집계수가 높다는 것이, 군집의 생성과 어떤 관계를 가지고 있는 것일까. 정점 v의 지역적 군집계수가 매우 높다고 하자. 이는 <u>정점 v의 이웃들도 높은 확률로 서로 간선으로 연결이 되어 있음을 의미</u>한다. 따라서 정점 v와 그 이웃들은 높은 확률로 군집을 형성한다. 

### 전역적 군집 계수
**전역 군집 계수**(Global Clustering Coefficient)는 전체 그래프에서 군집의 형성 정도를 측정한다. 그래프 \\(G\\)의 전역 군집 계수는 **각 정점에서의 지역적 군집 계수의 평균**이다. 단, 지역적 군집 계수가 정의되지 않는 정점은 제외한다.

### 실제 그래프와 군집 계수
실제 그래프에서는 군집계수가 높아, 군집이 많이 존재한다. 여기에는 여러가지 이유가 있을 수 있지만, 그 중 2가지에 대해서 알아보자.

1. 동질성  
**동질성(Homophily)**는 서로 유사한 정점끼리 간선으로 연결될 가능성이 높다. 현실에서 예시로 같은 동네에 사는 같은 나이의 아이들이 친구가 되는 경우가 있다. 또한 같은 언어를 사용하는 인종끼리 친하게 지내는 것도 하나이다.

2. 전이성  
**전이성(Transitivity)**는 공통 이웃이 있는 경우, 공통 이웃이 매개역할을 해줄 수 있다. 현실에서 친구가 내가 모르는 친구를 소개시켜주는 것과 같다. 극단적으로, 100명의 친구가 있는데 각 친구에게 서로 모두 소개시켜주면 하나의 군집이 형성된다.

### 랜덤 그래프와 군집 계수
랜덤 그래프에서는 지역적 혹은 전역 군집 계수가 높지 않다. 구체적으로 랜덤 그래프 \\(G(n, p)\\)에서 군집계수는 \\(p\\)이다. 랜덤 그래프에서의 간선 연결이 서로 **독립적**인 것을 고려하면 매우 당연한 결과이다. 공통 이웃의 존재 여부가 간선 연결 확률에 영향을 미치지 않아 동질성과 전이성이 존재하지 않고, 이는 다시 군집 생성 확률이 낮다는 것을 의미한다.