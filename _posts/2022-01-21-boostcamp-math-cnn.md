---
title:  "[AI Math] CNN"
excerpt: "Convolution ì—°ì‚°ê³¼ ë‹¤ì–‘í•œ ì°¨ì›ì—ì„œì˜ ì—°ì‚°ë°©ë²•ê³¼ ì—­ì „íŒŒ"

categories:
  - boostcamp
tags:
  - [AI, Naver, BoostCamp, Python, Math]
toc: true
toc_sticky: true
 
date: 2022-01-20 03:00:00
last_modified_at: 2022-01-20 03:00:00
---
ğŸ“Œ **ì•Œë¦½ë‹ˆë‹¤!**<br>
ì´ë²ˆì— ì‘ì„±ë˜ëŠ” ê¸€ì€ **ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ìº í”„ AI Tech**ë¥¼ ìˆ˜ê°•í•˜ë©° ì •ë¦¬í•˜ëŠ” ê¸€ì…ë‹ˆë‹¤.<br>
ì—¬ê¸°ì„œ ì¡´ì¬í•˜ëŠ” ê°•ì˜ ìë£Œì˜ ì¶œì²˜ëŠ” ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ì½”ìŠ¤/ìº í”„ì—ê²Œ ìˆìŠµë‹ˆë‹¤.
{: .notice--info}

# Convolution ì—°ì‚°

## ë„ì…
![image](https://user-images.githubusercontent.com/91870042/145152531-68e147f2-0c7e-4f3e-908b-9e7e3d0c38ec.png){: .align-center}

ì§€ê¸ˆê¹Œì§€ ë°°ìš° ë‹¤ì¸µì‹ ê²½ë§(MLP)ì€ ê° ë‰´ëŸ°ë“¤ì´ ì„ í˜•ëª¨ë¸ê³¼ í™œì„±í•¨ìˆ˜ë¡œ ëª¨ë‘ ì—°ê²°ëœ êµ¬ì¡°ì˜€ë‹¤. ìœ„ì˜ ê·¸ë¦¼ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë“¯ì´, **ê° ì„±ë¶„ \\(h_i\\)ì— ëŒ€ì‘í•˜ëŠ” ê°€ì¤‘ì¹˜ í–‰ \\(W_i\\)ê°€ í•„ìš”**í•˜ì˜€ë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— ê³„ì‚°í•˜ëŠ” iê°€ ë°”ë€Œë©´ ì‚¬ìš©ë˜ëŠ” ê°€ì¤‘ì¹˜(Wê°’)ë„ ë°”ë€Œê²Œ ë˜ì–´ì„œ ë‹¤ë¥¸ ê²°ê³¼ê°’ì´ ë„ì¶œë˜ì—ˆë‹¤. í•˜ì§€ë§Œ `Convolutionì—°ì‚°`ì€ ì´ì™€ ë‹¬ë¦¬ **ì»¤ë„ì„ ì…ë ¥ë²¡í„° ìƒì—ì„œ ì›€ì§ì—¬ê°€ë©´ì„œ** ì„ í˜•ëª¨ë¸ê³¼ í•©ì„±í•¨ìˆ˜ê°€ ì ìš©ë˜ëŠ” êµ¬ì¡°ì´ë‹¤.

## Convolution ì—°ì‚°
![image](https://user-images.githubusercontent.com/91870042/145152651-2c027ecb-ba49-4046-acc3-811b96742c9c.png){: .align-center}

Convolutionì—°ì‚°ì€ ëª¨ë“  \\(i\\)ì— ëŒ€í•´ ì ìš©ë˜ëŠ” ì»¤ë„ì´ \\(V\\)ë¡œ ê°™ê³ , ì»¤ë„ì˜ ì‚¬ì´ì¦ˆë§Œí¼ \\(X\\)ìƒì—ì„œ ì´ë™í•˜ë©´ì„œ ì ìš©ëœë‹¤.

ë‹¤ì¸µì‹ ê²½ë§ê³¼ ë¹„ìŠ·í•˜ê²Œ ì»¤ë„ì„ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°ë„ ì„ í˜•ë³€í™˜ì˜ í•œ ì¢…ë¥˜ì´ì§€ë§Œ, **ê°€ì¤‘ì¹˜ í–‰ë ¬(ì»¤ë„)ì´ ì…ë ¥ë²¡í„°ìƒì—ì„œ ì›€ì§ì—¬ ê°€ë©´ì„œ í•œë‹¤**ëŠ” ê²ƒì´ ì°¨ì´ì ì´ë‹¤. ë•ë¶„ì— ê°€ì¤‘ì¹˜ í–‰ë ¬ì˜ í¬ê¸°ê°€ ëŒ€í­ ì¤„ì–´ parameterì˜ í¬ê¸°ë¥¼ ë§ì´ ì¤„ì¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

## ìˆ˜í•™ì  ì˜ë¯¸
`convolution ì—°ì‚°`ì˜ ìˆ˜í•™ì ì¸ ì˜ë¯¸ëŠ” `ì‹ í˜¸`ë¥¼ `ì»¤ë„`ì„ ì´ìš©í•´ **êµ­ì†Œì ìœ¼ë¡œ ì¦í­ ë˜ëŠ” ê°ì†Œì‹œì¼œì„œ ì •ë³´ë¥¼ ì¶”ì¶œ ë˜ëŠ” í•„í„°ë§í•˜ëŠ” ê²ƒ**ì´ë‹¤. ì•„ë˜ ì‚¬ì§„ì€ ìˆ˜ì‹ì„ ë‚˜íƒ€ë‚¸ ê²ƒìœ¼ë¡œ, ì»¤ë„ì€ \\(f\\)ë¡œ, ì‹ í˜¸ëŠ” \\(g\\)ë¡œ í‘œí˜„ë˜ì–´ ìˆë‹¤. í•˜ì§€ë§Œ ìˆ˜ì‹ë§Œìœ¼ë¡œ í•´ì„í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì–´ë µë‹¤.

![image](https://user-images.githubusercontent.com/91870042/145152891-44e417b8-435a-4df1-8615-3505791e8b07.png){: .align-center}

CNNì—ì„œ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°ì€ ì‚¬ì‹¤ convolutionì—°ì‚°ì´ ì•„ë‹ˆê³ , `cross-correlationì—°ì‚°` ì´ë¼ê³  ë¶€ë¥¸ë‹¤. í•˜ì§€ë§Œ ê´€ìš©ì ìœ¼ë¡œ convolutionì—°ì‚°ì´ë¼ê³  ë¶€ë¥¸ë‹¤.

### ê·¸ë¦¼ì„ í†µí•œ Convolutionì—°ì‚°ì˜ ì´í•´
ì»¤ë„ì€ ì •ì˜ì—­ ë‚´ì—ì„œ ì›€ì§ì—¬ë„ `ë³€í•˜ì§€ ì•Šê³ (translation invariant)` ì£¼ì–´ì§„ ì‹ í˜¸ì— `êµ­ì†Œì (local)`ìœ¼ë¡œ ì ìš©í•œë‹¤.

> íŒŒë€ìƒ‰: ì‹ í˜¸, ë¹¨ê°„ìƒ‰: ì»¤ë„, ê²€ì€ìƒ‰: ê²°ê³¼

![Convolution_of_box_signal_with_itself2](https://user-images.githubusercontent.com/91870042/145153661-9317211c-8e9c-4d6d-acd6-7f5dbb940c12.gif){: .align-center}

![Convolution_of_spiky_function_with_box2](https://user-images.githubusercontent.com/91870042/145153690-5e436849-5ef5-4d0e-9335-1aad0e7436b9.gif){: .align-center}

GIFì¶œì²˜: https://en.wikipedia.org/wiki/Convolution

ìœ„ì˜ ì˜ìƒì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´, ì •ì˜ì—­ì€ ê°€ë§Œíˆ ìˆì§€ë§Œ, ë¹¨ê°„ìƒ‰ ì»¤ë„ì´ ì›€ì§ì—¬ê°€ë©´ì„œ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ê²€ì •ìƒ‰ì„ ì€ ì •ì˜ì—­ì—ì„œ ì»¤ë„ì´ ì–¼ë§Œí¼ ì°¨ì§€í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ë©´ì„œ ê·¸ë ¤ì§„ë‹¤.

## ì˜ìƒì²˜ë¦¬ì—ì„œ convolutionì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•
í•˜ë‚˜ì˜ ì´ë¯¸ì§€ì—ì„œ ì»¤ë„ê°’ì„ ì¡°ì ˆí•´ê°€ë©´ì„œ ì´ë¯¸ì§€ë¥¼ ë³€ê²½í•˜ëŠ” ê²ƒì´ ê°€ëŠ¥í•˜ë‹¤. ì»¤ë„ê°’ì˜ ì„¤ì •ì— ë”°ë¼ì„œ ì´ë¯¸ì§€ì˜ noiseë¥¼ ì œê±°í•  ìˆ˜ë„ ìˆê³ , ë‹¤ì–‘í•œ íš¨ê³¼ë¥¼ ì£¼ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤.

<br>

# ë‹¤ì–‘í•œ ì°¨ì›ì—ì„œì˜ convolution
convolutionì—°ì‚°ì€ 1ì°¨ì› ë¿ë§Œì•„ë‹ˆë¼ ë‹¤ì–‘í•œ ì°¨ì›ì—ì„œ ê³„ì‚°ì´ ê°€ëŠ¥í•˜ë‹¤. ì•„ë˜ ìˆ˜ì‹ì—ì„œ ì…ë ¥ë°›ëŠ” ì¸ìì˜ ìˆ˜ì™€ \\(i, j, k\\)ì˜ ê°’ì´ ë°”ë€Œì–´ë„ ì»¤ë„ \\(f\\)ì˜ ê°’ì€ ë³€ê²½ë˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

![image](https://user-images.githubusercontent.com/91870042/145154007-70ac6cf2-bb79-496e-a28b-56b1975a6310.png){: .align-center}

## 2ì°¨ì› Convolution ì—°ì‚°
2ì°¨ì› Convolutionì—°ì‚°ì€ ì»¤ë„ì„ ì…ë ¥ë²¡í„° ìƒì—ì„œ ì›€ì§ì—¬ê°€ë©´ì„œ ì„ í˜•ëª¨ë¸ê³¼ í•©ì„±í•¨ìˆ˜ê°€ ì ìš©ë˜ëŠ” êµ¬ì¡°ì´ë‹¤. ì´ë•Œ ë‘ í–‰ë ¬ê°„ì˜ ê³±ì…ˆì—°ì‚°ì€ `í–‰ë ¬ì˜ ì„±ë¶„ê³±`ì„ ìˆ˜í–‰í•œë‹¤. í–‰ë ¬ì˜ ì„±ë¶„ê³±ì€ ë‘ í–‰ë ¬ì˜ ë™ì¼í•œ ìœ„ì¹˜ì— ìˆëŠ” ê°’ë¼ë¦¬ì˜ ê³±ì…ˆì„ ë§í•œë‹¤.

![image](https://user-images.githubusercontent.com/91870042/145154326-7fcf378a-fb81-4935-8530-3b8ab402b023.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145154504-00c387a4-12b1-4f34-9c2d-136108bc6ce4.png){: .align-center}

ìœ„ì˜ ì—°ì‚°ì„ í†µí•´ì„œ ì–»ì–´ë‚¸ ì¶œë ¥ì´ ìˆì„ ë•Œ, ì…ë ¥í¬ê¸°ë¥¼ \\((H, W)\\), ì»¤ë„ í¬ê¸°ë¥¼ \\((K_H, K_W)\\), ì¶œë ¥í¬ê¸°ë¥¼ \\((O_H, O_W)\\)ë¼ í•˜ë©´,ì¶œë ¥ì˜ í¬ê¸°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì—°ì‚°í•  ìˆ˜ ìˆë‹¤. 

- \\(O_H = H - K_H + 1\\)
- \\(O_W = W - K_W + 1\\)

ì±„ë„ì´ ì—¬ëŸ¬ê°œì¸ 2ì°¨ì› ì…ë ¥ì˜ ê²½ìš°, 2ì°¨ì› Convolutionì„ `ì±„ë„ ê°œìˆ˜ë§Œí¼ ì ìš©`ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤. ì°¸ê³ ë¡œ, 3ì°¨ì›ë¶€í„°ëŠ” í–‰ë ¬ì´ ì•„ë‹Œ í…ì„œë¼ê³  ë¶€ë¥¸ë‹¤. ë˜í•œ, ì±„ë„ì´ ì—¬ëŸ¬ê°œì¸ ê²½ìš° ì»¤ë„ì˜ ì±„ë„ìˆ˜ì™€ ì…ë ¥ì˜ ì±„ë„ìˆ˜ê°€ ë™ì¼í•´ì•¼í•œë‹¤.

![image](https://user-images.githubusercontent.com/91870042/145154774-2af0d34f-47fa-4f84-93f9-af7991d369ad.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145155068-3d4514c5-1270-418a-8214-dba6bf6f0d4b.png){: .align-center}

ìœ„ì˜ ì—°ì‚°ì„ 2ê°œì˜ ì§ìœ¡ë©´ì²´ í…ì„œê°„ì˜ ê³±ìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆë‹¤. ê²°ê³¼ê°’ì€ ê° ì±„ë„ì—ì„œ ì—°ì‚°í•œ ê²°ê³¼ì˜ í•©ì´ê¸° ë•Œë¬¸ì— ì¶œë ¥ê°’ì€ ë†’ì´ê°€ 1ì¸ í–‰ë ¬ë¡œ í‘œí˜„ì´ ëœë‹¤. ì¶œë ¥ë„ í…ì„œë¡œ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ì»¤ë„ì˜ ìˆ˜ë¥¼ ì—¬ëŸ¬ê°œë¡œ ë§Œë“¤ë©´ ëœë‹¤. 

í•˜ë‚˜ì˜ ì§ìœ¡ë©´ì²´ ì»¤ë„ë‹¹ ì¶œë ¥ì€ 2ì°¨ì› í–‰ë ¬ê°’ì´ ë‚˜ì™”ë‹¤ë©´, ì—¬ëŸ¬ê°œì˜ ì»¤ë„ì„ ê°€ì§€ê³  ê³±ì…ˆì„ í•˜ê²Œ ë˜ë©´ ì¶œë ¥ë„ í…ì„œí˜•íƒœê°€ ë˜ëŠ” ê²ƒì´ë‹¤.

<br>

# Convolution ì—°ì‚°ì˜ ì—­ì „íŒŒ
![image](https://user-images.githubusercontent.com/91870042/145159386-ee65ad15-b48f-4db8-b73a-520f27aaaa40.png){: .align-center}

Convolutionì—°ì‚°ì€ **ì»¤ë„ì´ ëª¨ë“  ì…ë ¥ ë°ì´í„°ì— ê³µí†µìœ¼ë¡œ ì ìš©**ë˜ê¸° ë•Œë¬¸ì— ì—­ì „íŒŒë¥¼ ê³„ì‚°í•  ë•Œë„ convolutionì—°ì‚°ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤. ì´ ê³¼ì •ì€ ìœ„ì˜ ìˆ˜ì‹ë³´ë‹¤ ì•„ë˜ì˜ ì²¨ë¶€ëœ ê°•ì˜ìë£Œë¡œ ë³´ë©´ í›¨ì”¬ ì´í•´í•˜ê¸°ê°€ ì‰½ë‹¤.

![image](https://user-images.githubusercontent.com/91870042/145159816-91f1a632-4fcb-4c1e-82fe-461e21be780f.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159709-bca6abd4-9163-4d73-a240-6a11c74d4214.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159837-99eb67a7-b513-4b26-b99b-6346b3ddfee4.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159861-720d0096-186c-4f3f-a0bc-31c69475796b.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159874-e9f66822-c551-4ff2-b595-23f2d3a59496.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159889-2d8b615b-949e-4224-9d48-68e6b1efdd41.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159917-bcf0803d-701a-4670-b089-801ee1889734.png){: .align-center}

![image](https://user-images.githubusercontent.com/91870042/145159949-a2ed5d2c-a01a-4461-94a3-67400fdde6b8.png){: .align-center}

<br>

# References

[ğŸ“˜ CNN, Convolutional Nerual Network ìš”ì•½](http://taewan.kim/post/cnn/)

[ğŸ“˜ Wikipedia: Convolution](https://en.wikipedia.org/wiki/Convolution)