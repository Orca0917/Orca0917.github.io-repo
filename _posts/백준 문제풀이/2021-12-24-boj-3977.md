---
title:  "[C++] ë°±ì¤€ 3977: ì¶•êµ¬ ì „ìˆ "
excerpt: "í”Œë˜í‹°ë„˜ â…£"

categories:
  - boj
tags:
  - [C++, ì•Œê³ ë¦¬ì¦˜, ê·¸ë˜í”„ ì´ë¡ , ê°•í•œ ì—°ê²° ìš”ì†Œ]
toc: true
toc_sticky: true
 
date: 2021-12-24
last_modified_at: 2021-12-24
---
ğŸ“Œ **ì•Œë¦½ë‹ˆë‹¤!**<br>
ë¬¸ì œ ë‚œì´ë„ì˜ ë¶„ë¥˜ì™€ ì¶œì²˜ëŠ” BOJì™€ Solved.acì— ìˆìŠµë‹ˆë‹¤.
{: .notice--info}

# 1. ë¬¸ì œ ì¶œì²˜
[<img src="https://static.solved.ac/tier_small/17.svg" style="width: 1em"> ë°±ì¤€_3977_ì¶•êµ¬ì „ìˆ ](https://www.acmicpc.net/problem/3977)

<br>

# 2. ë¬¸ì œ í•´ì„¤ & ë¶„ë¥˜

ë¬¸ì œì—ì„œ ë°©í–¥ê·¸ë˜í”„ê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ëª¨ë“  ì •ì ìœ¼ë¡œ ì´ë™ê°€ëŠ¥í•œ ì •ì ì„ ì¶œë ¥í•˜ëŠ” ë¬¸ì œì´ë‹¤. ê·¸ëŸ¬í•œ ì •ì ì´ ì—†ë‹¤ë©´, "Confused"ë¥¼ ì¶œë ¥í•˜ë©´ ëœë‹¤.

ë¨¼ì € ê°™ì€ SCCì— ì†í•œ ì •ì ë“¤ ê°„ì—ëŠ” ì„œë¡œì˜ ì´ë™ì´ ììœ ë¡­ê¸° ë•Œë¬¸ì— ê·¸ë˜í”„ë¥¼ ë‹¤ì‹œ SCCë¡œ ë¬¶ì¸ ê·¸ë˜í”„ë¡œ ë‹¤ì‹œ í‘œí˜„í•œë‹¤. SCCê·¸ë˜í”„ë¥¼ ìƒì„±í•˜ì˜€ë‹¤ë©´, ì´ì œ DAGê°€ ì™„ì„±ì´ ë˜ì—ˆë‹¤. DAGì—ì„œ **ë‚´ì°¨ìˆ˜ê°€ 0ì¸ ì •ì **ì„ ì°¾ì•„ì„œ ê·¸ ì •ì (SCC)ì— ì†í•œ ì •ì ë“¤ì„ ëª¨ë‘ ì¶œë ¥í•˜ë©´ ëœë‹¤.

ë§Œì•½, ë‚´ì°¨ìˆ˜ê°€ 0ì¸ ì •ì ì´ 1ê°œ ë³´ë‹¤ ë§ì€ ê²½ìš°ì—ëŠ” ëª¨ë“  ì •ì ì„ ë°©ë¬¸í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ê°€ ë˜ì–´ confusedë¥¼ ì¶œë ¥í•œë‹¤. ë‚´ì°¨ìˆ˜ê°€ 0ì¸ ì •ì ì´ 0ì¸ ê²½ìš°ëŠ” DAGê·¸ë˜í”„ ì´ê¸°ë•Œë¬¸ì— ì¡´ì¬í•  ìˆ˜ ì—†ë‹¤.

ë¶„ë¥˜: `ê·¸ë˜í”„ ì´ë¡ `, `ê°•í•œ ì—°ê²° ìš”ì†Œ`

<br>

# 3. ì •ë‹µ ì½”ë“œ

~~~cpp
#include <bits/stdc++.h>

using namespace std;

int n; // êµ¬ì—­ì˜ ìˆ˜ (ì •ì )
int m; // ì›€ì§ì„ì˜ ìˆ˜ (ê°„ì„ )

vector<int> adj[100001]; // ì…ë ¥ìœ¼ë¡œ ë°›ëŠ” ê·¸ë˜í”„
vector<int> sccGraph[100001]; // SCCë¡œ ì¬êµ¬ì„±í•œ ê·¸ë˜í”„
vector<int> inDegree(100001, 0); // sccGraphì˜ indegreeë¥¼ ê¸°ë¡

vector<int> sccID(100001, -1), discovered(100001, -1);
int sccNum = 0, vertexNum = 0;

// í•˜ë‚˜ì˜ SCCë¡œ ë¬¶ê¸° ìœ„í•œ ìŠ¤íƒ
stack<int> st;

int scc(int here) {
    int ret = discovered[here] = vertexNum++;
    st.push(here);

    for (int there : adj[here]) {
        if (discovered[there] == -1)
            ret = min(ret, scc(there));
        else if (sccID[there] == -1)
            ret = min(ret, discovered[there]);
    }

    if (ret == discovered[here]) {
        while (true) {
            int now = st.top(); st.pop();
            sccID[now] = sccNum;
            if (now == here) break;
        }
        ++sccNum;
    }

    return ret;
}

vector<int> tarjanSCC() {
    for (int vertex = 0; vertex < n; ++vertex) {
        if (discovered[vertex] == -1)
            scc(vertex);
    }

    // SCCê·¸ë˜í”„ ìƒì„±
    for (int vertex = 0; vertex < n; ++vertex) {
        for (int there : adj[vertex]) {
            if (sccID[vertex] != sccID[there]) {
                sccGraph[vertex].push_back(sccID[there]);
                ++inDegree[sccID[there]];
            }
        }
    }

    // inDegree ê²€ì‚¬
    vector<int> zeroIndegree;
    for (int i = 0; i < sccNum; ++i) {
        if (inDegree[i] == 0) {
            zeroIndegree.push_back(i);
        }
    }

    return zeroIndegree;
}

int main() {
    // ë¹ ë¥¸ ì…ì¶œë ¥
    ios_base::sync_with_stdio(false);
    cin.tie(nullptr);
    cout.tie(nullptr);

    int testcase; cin >> testcase;
    while (testcase--) {
        // í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë§ˆë‹¤ ì´ˆê¸°í™” ë˜ì–´ì•¼ í•˜ëŠ” ë³€ìˆ˜
        fill(sccID.begin(), sccID.end(), -1);
        fill(discovered.begin(), discovered.end(), -1);
        fill(inDegree.begin(), inDegree.end(), 0);
        for (int i = 0; i < 100001; ++i) { adj[i].clear(); sccGraph[i].clear(); }

        sccNum = 0, vertexNum = 0;

        cin >> n >> m;

        for (int i = 0; i < m; ++i) {
            int from, to; cin >> from >> to;
            adj[from].push_back(to);
        }

        vector<int> zeroIndegree = tarjanSCC();
        if (zeroIndegree.size() == 1) {
            for (int v = 0; v < n; ++v) 
                if (sccID[v] == zeroIndegree[0])
                    cout << v << "\n";
        } else {
            cout << "Confused\n";
        }

        cout << "\n";
    }

}
~~~