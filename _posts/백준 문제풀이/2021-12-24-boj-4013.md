---
title:  "[C++] ë°±ì¤€ 4013: ATM"
excerpt: "í”Œë˜í‹°ë„˜ â…¡"

categories:
  - boj
tags:
  - [C++, ì•Œê³ ë¦¬ì¦˜, ë‹¤ì´ë‚˜ë¯¹ í”„ë¡œê·¸ë˜ë°, ê·¸ë˜í”„ ì´ë¡ , ê°•í•œ ì—°ê²° ìš”ì†Œ, ìœ„ìƒ ì •ë ¬]
toc: true
toc_sticky: true
 
date: 2021-12-24
last_modified_at: 2021-12-24
---
ğŸ“Œ **ì•Œë¦½ë‹ˆë‹¤!**<br>
ë¬¸ì œ ë‚œì´ë„ì˜ ë¶„ë¥˜ì™€ ì¶œì²˜ëŠ” BOJì™€ Solved.acì— ìˆìŠµë‹ˆë‹¤.
{: .notice--info}

# 1. ë¬¸ì œ ì¶œì²˜
[<img src="https://static.solved.ac/tier_small/19.svg" style="width: 1em"> ë°±ì¤€_4013_ATM](https://www.acmicpc.net/problem/4013)

<br>

# 2. ë¬¸ì œ í•´ì„¤ & ë¶„ë¥˜

ë¬¸ì œì—ì„œ ì£¼ì–´ì§€ëŠ” ê·¸ë˜í”„ì—ì„œ ìµœëŒ€í•œ ë§ì€ ATMì„ ê±°ì³ ì‹ë‹¹ìœ¼ë¡œ ê°€ì•¼í•œë‹¤. ê·¸ë ‡ê²Œ í•˜ê¸° ìœ„í•´ì„œ í•˜ë‚˜ì˜ SCCì•ˆì— ì†í•œ ì •ì ë“¤ ê°„ì—ëŠ” ì´ë™ì´ ììœ ë¡­ê¸° ë•Œë¬¸ì— SCCë¼ë¦¬ ë¬¶ê³ , ê·¸ SCCì—ì„œ ì–»ì„ ìˆ˜ ìˆëŠ” ìµœëŒ€ì˜ ìˆ˜ìµì„ ë”°ë¡œ ê¸°ë¡í•œë‹¤.

SCCë¼ë¦¬ ë¬¶ì€ ê²ƒì„ í•˜ë‚˜ì˜ ì •ì ìœ¼ë¡œ ê°„ì£¼í•˜ì—¬ ìƒˆë¡œìš´ SCCê·¸ë˜í”„ë¥¼ ìƒì„±í•˜ê³ , ê·¸ ë•Œ ì–»ì„ ìˆ˜ ìˆëŠ” ìµœëŒ€ ì´ìµì„ ë”°ë¡œ ì €ì¥í•œë‹¤.

`tarjan's algorithm`ì—ì„œ SCCì˜ ìƒì„±ìˆœì„œëŠ” **ìœ„ìƒì •ë ¬ì˜ ì—­ìˆœì„ì„ ì´ìš©**í•´ì„œ ì¶œë°œì§€ì ë¶€í„° ì‹œì‘í•˜ì—¬ SCC_IDê°€ ì¤„ì–´ë“œëŠ” ë°©í–¥ìœ¼ë¡œ ìµœëŒ€ ì´ìµì„ ê³„ì‚°í•œë‹¤. ì´ë•Œ ë™ì ê³„íšë²•ì„ ì‚¬ìš©í•˜ê³  ì í™”ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

\begin{aligned}
    memo[there] = max(memo[there], memo[here] + totalSum[there])
\end{aligned}

- memo[there]: thereì— ë„ì°©í–ˆì„ ë•Œ, ì–»ì„ ìˆ˜ ìˆëŠ” ìµœëŒ€ ì´ìµì„ ì˜ë¯¸í•œë‹¤.
- totalSum[there]: SCCIDê°€ thereì¸ ì •ì ë“¤ì— ì¡´ì¬í•˜ëŠ” ATM ì”ê³ ì˜ ì´ í•©ì´ë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ, ë ˆìŠ¤í† ë‘ì´ ì—†ëŠ” SCCë„ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ë ˆìŠ¤í† ë‘ì´ ìˆëŠ” ì •ì ì— ëŒ€í•´ì„œ ì •ë‹µì„ ë„ì¶œí•˜ë©´ ëœë‹¤. ëª¨ë“  ì •ì ì„ ëŒë©´ì„œ ë ˆìŠ¤í† ë‘ì´ ìˆëŠ” ì •ì ì˜ SCCIDì— ëŒ€í•´ì„œ ì•„ê¹Œ ì—°ì‚°í•œ memoê°’ì„ ì¶œë ¥í•´ë„ ë˜ê³ , ê° SCCì— ë ˆìŠ¤í† ë‘ì´ ì¡´ì¬í•˜ëŠ”ì§€ êµ¬ë¶„í•˜ê³  ì—°ì‚°í•´ë„ ëœë‹¤.

ë¶„ë¥˜: `ë‹¤ì´ë‚˜ë¯¹ í”„ë¡œê·¸ë˜ë°`, `ê·¸ë˜í”„ ì´ë¡ `, `ê°•í•œ ì—°ê²° ìš”ì†Œ`, `ìœ„ìƒ ì •ë ¬`

<br>

# 3. ì •ë‹µ ì½”ë“œ

~~~cpp
#include <bits/stdc++.h>
#define ll long long
using namespace std;

// êµì°¨ë¡œì˜ ìˆ˜ì™€ ë„ë¡œì˜ ìˆ˜
int n, m;
// êµì°¨ë¡œ ì—°ê²° ì •ë³´ë¥¼ ê°€ì§„ ì¸ì ‘ ë¦¬ìŠ¤íŠ¸ ìƒì„±
vector<int> adj[500001];
vector<int> sccGraph[500001];
vector<int> balance(500001, 0);
vector<ll> memo(500001, -1);

vector<bool> isRestaurant(500001, false);

vector<int> sccID(500001, -1);
vector<int> discovered(500001, -1);
vector<ll> accSum(500001, 0);
int sccNumber = 0, discoverNumber = 0;

stack<int> st;

// ì¶œë°œì¥ì†Œì™€ ë ˆìŠ¤í† ë‘ì˜ ê°œìˆ˜
int s, p;

int scc(int here) {
    int ret = discovered[here] = discoverNumber++;
    st.push(here);

    for (int there : adj[here]) {
        if (discovered[there] == -1)
            ret = min(ret, scc(there));
        else if (sccID[there] == -1)
            ret = min(ret, discovered[there]);
    }

    if (ret == discovered[here]) {
        while (true) {
            int now = st.top(); st.pop();
            sccID[now] = sccNumber;
            if (now == here) break;
        }
        ++sccNumber;
    }
    return ret;
}

void tarjanSCC() {
    for (int i = 1; i <= n; ++i)
        if (discovered[i] == -1)
            scc(i);

    // make scc graph
    for (int here = 1; here <= n; ++here)
        for (auto there : adj[here])
            if (sccID[here] != sccID[there])
                sccGraph[sccID[here]].push_back(sccID[there]);
}


int main() {
    ios_base::sync_with_stdio(false);
    cin.tie(0); cout.tie(0);

    cin >> n >> m;

    for (int i = 0; i < m; ++i) {
        int from, to; cin >> from >> to;
        adj[from].push_back(to);
    }

    for (int i = 1; i <= n; ++i)
        cin >> balance[i];
    
    cin >> s >> p;
    for (int i = 0; i < p; ++i) {
        int restaurant; cin >> restaurant;
        isRestaurant[restaurant] = true;
    }

    tarjanSCC();

    for (int i = 1; i <= n; ++i) {
        accSum[sccID[i]] += balance[i];
    }

    s = sccID[s];
    memo[s] = accSum[s];

    for (int here = s; here > 0; --here) {
        if (memo[here] == -1) continue;
        for (auto there: sccGraph[here]) {
            memo[there] = max(memo[there], memo[here] + accSum[there]);
        }
    }

    ll answer = 0;
    for (int i = 1; i <= n; ++i)
        if (isRestaurant[i])
            answer = max(answer, memo[sccID[i]]);
    
    cout << answer << "\n";

    return 0;
}
~~~